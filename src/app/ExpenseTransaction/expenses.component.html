<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
  integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

<!-- Add top navigation componant -->
<app-authorised-top-nav></app-authorised-top-nav>

<div class="row">
  <div class="col-md-2">
    <!-- Add left navigation componant -->
    <app-authorised-side-nav></app-authorised-side-nav>
  </div>
  <div class="col-md-10 overflow-auto">


    <div class="float-right" style="margin-top: 20px;margin-right: 20px">
      <button type="button" class="btn btn-primary" style="margin-left:100px" (click)="addNewExpense(addExpense)">Add
        Expenses</button>
    </div>
    <div class="container" style="margin-top:100px">

      <!-- <div class="table-responsive"> -->
      <!-- <table class="table table-striped"> -->
      <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="row-border hover">
        <thead>
          <tr>
            <th>Expense Type</th>
            <th>Date</th>
            <th>Paid By Whom</th>
            <th>Amount Paid</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let e of expenses; let i=index">
            <td>{{e.ExpenseType}}</td>
            <td>{{e.Date | date:'mediumDate'}}</td>
            <td>{{e.PaidByName}}</td>
            <td>{{e.Paid}}</td>
            <td class="text-center">
              <button type="btn" class="btn btn-default" data-toggle="tooltip" title="Edit" data-placement="bottom"
                (click)="edit(editExpense,e)"><i class="fas fa-pencil-alt"></i></button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>


  <ng-template #editExpense>

    <div class="modal-header">
      <h4 class="modal-title pull-left">Update Expense</h4>
      <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="editExpenseForm" (ngSubmit)="onSubmitEdit()">
        <div class="form-group">
          <label for="ExpenseType">ExpenseType</label>

          <select name="ExpenseType" class="form-control" formControlName="ExpenseType" [value]="form.ExpenseId.value"
            [ngClass]="{'is-invalid': submitted && form.ExpenseType.errors} ">
            <option [value]="null">Select Name</option>
            <option *ngFor="let expense of ExpenseService.listExpenseType" [value]="expense.ExpenseId">
              {{expense.Expenses}}
              <!-- {{expense.ExpenseType}} -->
            </option>
          </select>
          <div *ngIf="submitted && form.ExpenseType.errors">
            <div *ngIf="form.ExpenseType.errors.required">ExpenseType is required</div>
          </div>
        </div>

        <div class="form-group">
          <label for="AmountPaid">Amount Paid</label>
          <input type="text" class="form-control" id="AmountPaid" formControlName="AmountPaid" placeholder="Amount Paid"
            [ngClass]="{'is-invalid': submitted && form.AmountPaid.errors} ">

          <div *ngIf="submitted && form.AmountPaid.errors">
            <div *ngIf="form.AmountPaid.errors.required">AmountPaid is required</div>
          </div>
        </div>

        <div class="form-group">
          <label for="Date">Date</label>
          <input class="form-control" formControlName="Date" [ngClass]="{'is-invalid': submitted && form.Date.errors }">
          <div *ngIf="submitted && form.Date.errors">
            <div *ngIf="form.Date.errors.required">Date is required</div>
          </div>
        </div>

        <div class="form-group">
          <label for="PaidByName">Paid By Whom</label>
          <select name="PaidByName" class="form-control" formControlName="PaidByName" [value]="form.PaidByWhom.value"
            [ngClass]="{'is-invalid': submitted && form.PaidByName.errors} ">
            <option *ngFor="let staff of staffMasters" [value]="staff.StaffId">
              <!-- {{user.FirstName+' '+user.LastName}} -->
              <span>{{staff.FirstName+' '}}</span> <span>{{ staff.MiddleName}}</span>
              <span>{{' '+ staff.LastName}}</span>
            </option>
          </select>
         <div *ngIf="submitted && form.PaidByName.errors">
            <div *ngIf="form.PaidByName.errors.required">Paid By Whom is required</div>
          </div>
        </div>

        <div class="form-group">
          <label for="Remark">Remark</label>
          <input type="text" class="form-control" id="Remark" formControlName="Remark"
            [ngClass]="{'is-invalid': submitted && form.Remark.errors} ">
         <div *ngIf="submitted && form.Remark.errors">
            <div *ngIf="form.Remark.errors.required">Remark is required</div>
          </div>
        </div>

        <div class="form-group">
          <button type="button" type="submit" style="margin-left: 5px" class="btn btn-primary">submit</button>
          <button type="button" class="btn btn-primary" data-dismiss="modal" style="margin-left: 5px"
            (click)="modalRef.hide()">Cancel</button>
        </div>
      </form>
    </div>
  </ng-template>

  <!-- Add Expense -->


  <ng-template #addExpense>
    <div class="modal-header">
      <h4 class="modal-title pull-left">Add Expense</h4>
      <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="expenseForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="ExpenseType">Expense Type</label>
          <select name="ExpenseType" id="ExpenseType" class="form-control" formControlName="ExpenseType"
            [ngClass]="{'is-invalid': submitted && f.ExpenseType.errors} ">
            <option *ngFor="let expense of expenseMaster" [value]="expense.ExpenseId">
              {{expense.Expenses}}
            </option>
          </select>
          <div *ngIf="submitted && f.ExpenseType.errors">
            <div *ngIf="f.ExpenseType.errors.required">*</div>
          </div>
        </div>

        <div class="form-group">
          <label for="AmountPaid">Amount Paid</label>
          <input type="text" class="form-control" id="AmountPaid" formControlName="AmountPaid" placeholder="Amount Paid"
            [ngClass]="{'is-invalid': submitted && f.AmountPaid.errors} ">
          <div *ngIf="submitted && f.AmountPaid.errors">
            <div *ngIf="f.AmountPaid.errors.required">*</div>
          </div>
        </div>

        <div class="form-group">
          <label for="Date">Date</label>
          <input class="form-control" id="Date" formControlName="Date"
            [ngClass]="{'is-invalid': submitted && f.Date.errors }">

          <div *ngIf="submitted && f.Date.errors">
            <div *ngIf="f.Date.errors.required">*</div>
          </div>
        </div>

        <div class="form-group">
          <label for="PaidByWhom">Paid By Whom</label>
          <select name="PaidByWhom" class="form-control" formControlName="PaidByWhom" (change)="selectUser($event)"
            [ngClass]="{'is-invalid': submitted && f.PaidByWhom.errors} ">
            <option *ngFor="let staff of staffMasters" [value]="staff.StaffId">
              <!-- {{user.FirstName+' '+user.LastName}} -->
              <span>{{staff.FirstName+' '}}</span> <span>{{ staff.MiddleName}}</span>
              <span>{{' '+ staff.LastName}}</span>
            </option>
          </select>
          <div *ngIf="submitted && f.PaidByWhom.errors">
            <div *ngIf="f.PaidByWhom.errors.required">*</div>
          </div>
        </div>

        <div class="form-group">
          <label for="Remark">Remark</label>
          <input type="text" class="form-control" id="Remark" formControlName="Remark"
            [ngClass]="{'is-invalid': submitted && f.Remark .errors} ">
          <div *ngIf="submitted && f.Remark.errors">
            <div *ngIf="f.Remark.errors.required">*</div>
          </div>
        </div>

        <div class="form-group">
          <button type="button" type="submit" style="margin-left: 5px" class="btn btn-primary">submit</button>
          <button type="button" class="btn btn-primary" style="margin-left: 5px" data-dismiss="modal"
            (click)="modalRef.hide()">Cancel</button>
        </div>
      </form>
    </div>
  </ng-template>