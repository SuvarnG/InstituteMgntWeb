<!-- Breadcrumb-->
<ol class="breadcrumb">
    <div class="flex-1 d-inline-flex">
    <li class="breadcrumb-item active align-self-center"><a routerLink="/Dashboard">Home</a></li>
    <li class="breadcrumb-item active align-self-center"><a routerLink="/reports">Reports</a></li>
    <li class="breadcrumb-item align-self-center">Expense Report</li>
    </div>
    <div class="d-none d-md-block d-lg-block d-xl-block flex-1">
        <li class="h5 pt-2">Manage Expense Reports</li> 
      </div>
      <li class="breadcrumb-menu d-md-down-none flex-1 justify-content-end text-right">   
        </li>
    </ol>

    <form [formGroup]="registerExpensesReport" (ngSubmit)="pullExpenseReport()">
        <div class="container-fluid">
            <div id="ui-view">
<div class="card border-0 shadow rounded-0">
    <div class="card-body">
      <div class="row ">
        <div class="col-lg-12 py-2">
          <div class="form-row ">
            <div class="col-lg-2">
              <label for="BranchName">Branch</label>
              <select class="form-control" [value]="null" formControlName="BranchName">
                <option value="null" disabled hidden>Select Branch</option>
                <option *ngFor="let b of branchList" [value]="b.BranchId">{{b.BranchName}}</option>
              </select>
            </div>
            <div class="col-lg-2">
                <label for="Expense">Expense</label>
              <select class="form-control" [value]="null" formControlName="Expense">
                <option value="null" disabled hidden>Select Expense</option>
                <option *ngFor="let e of expenseList" [value]="e.ExpenseId">{{e.Expenses}}</option>
              </select>
            </div>

            <div class="col-lg-2">
                <label for="period">Period</label>
              <select class="form-control" [value]="null" formControlName="period" (change)="selectPeriod($event)"
                [ngClass]="{ 'is-invalid': submitted && f.period.errors }">
                <option value="null" disabled hidden>Select Period</option>
                <option value="OneMonth">Last 1 Month</option>
                <option value="ThreeMonth">Last 3 Month</option>
                <option value="SixMonth">Last 6 Month</option>
                <option value="SelectDateRange">Date Range</option>
              </select>
              <div *ngIf="submitted && f.period.errors" class="invalid-feedback">
                <div *ngIf="f.period.errors.required">Period is required</div>
              </div>
            </div>

            <!-- <div class="col-lg-0.5" *ngIf="dateRange">
              <label class="h6 text-muted mt-3">From:</label>
            </div> -->

            <div class="col-lg-2" *ngIf="dateRange">
              <label>From</label>
              <input type="date" class="form-control" formControlName="FromDate"
                [ngClass]="{ 'is-invalid': submitted && f.FromDate.errors }">
              <div *ngIf="submitted && f.FromDate.errors" class="invalid-feedback">
                <div *ngIf="f.FromDate.errors.required">Date is required</div>
              </div>
            </div>

            <!-- <div class="col-lg-0.5" *ngIf="dateRange">
              <label class="h6 text-muted mt-3">To:</label>
            </div> -->

            <div class="col-lg-2" *ngIf="dateRange">
                <label>To</label>
              <input type="date" class="form-control" formControlName="ToDate"
                [ngClass]="{ 'is-invalid': submitted && f.ToDate.errors }">
              <div *ngIf="submitted && f.ToDate.errors" class="invalid-feedback">
                <div *ngIf="f.ToDate.errors.required">Date is required</div>
              </div>
            </div>

            <div class="col-lg-1 pt-1">
            <button type="submit" value="Search" class="btn btn-square btn-primary mt-4">Search</button>
           </div>
          </div>
        </div>
      </div>
      <div class="row justify-content-end mr-2 mt-1">
      <a class="button" (click)="exportAsXLSX()" title="Export Excel"><i class="fa fa-file-excel-o fa-1.5x" style="color:#008000" aria-hidden="true"></i></a>
      &nbsp;&nbsp;
        <a class="button" (click)="pdf.saveAs('expenseTable.pdf')" title="Download PDF"><i class="fa fa-file-pdf-o fa-1.5x" style="color:red" aria-hidden="true"></i></a>
      
        <!-- <button type="button" class="btn btn-dark btn-lg py-1 pr-3 rounded-0 f-20 ml-4" value="Export Excel"
        (click)="exportAsXLSX()">Export Excel</button>
      <button type="button" (click)="pdf.saveAs('expenseTable.pdf')" value="Download PDF"
        class="btn btn-dark btn-lg py-1 pr-3 rounded-0 f-20 ml-4">Download PDF</button>          -->
      </div>
   <!-- <div class="row">   -->
  <kendo-pdf-export #pdf paperSize="A4" margin="1cm" class=".k-widget">
    <table class="table table-striped">
      <tr>
        <th>Branch Name</th>
        <th>Expense Name</th>
        <th>Amount Paid</th>
        <th>Date</th>
        <th>Paid By</th>
      </tr>
      <tr *ngFor="let e of expenseReportList | paginate: { itemsPerPage: 10, currentPage: p }">
        <td>{{e.BranchName}}</td>
        <td>{{e.ExpenseName}}</td>
        <td>{{e.AmountPaid}}</td>
        <td>{{e.Date | date}}</td>
        <td>{{e.PaidBy}}</td>
      </tr>
    </table>
  </kendo-pdf-export>
<!-- </div>  -->
  <div class="text-center">
    <ul class="pagination" *ngIf="expenseReportList">
      <li >
        <pagination-controls class="span-pagination" (pageChange)="p = $event"></pagination-controls>
      </li>
    </ul>       
</div>
</div>
      </div>
    </div>
    </div>
    </form>



