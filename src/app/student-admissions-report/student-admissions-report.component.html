<app-authorised-top-nav></app-authorised-top-nav>

<div class="row">
  <div class="col-md-2">
 
  <app-authorised-side-nav></app-authorised-side-nav>
</div> 


<div class="col-md-10">

  <form [formGroup]="registerStudentAdmissionReport" (ngSubmit)="pullStudentAdmissionReport()">

    <h2>Student Admission Report</h2>
    <div class="form-row">
      <div class="col-lg-2">
          <label>Branch Name:</label>
          <select class="form-control"  formControlName="BranchName">
            <option *ngFor="let b of branchList" [value]="b.BranchId">{{b.BranchName}}</option>
          </select>
      </div>

      <div class="col-lg-2">
          <label>Course Name:</label>
          <select class="form-control" formControlName="CourseName">
            <option *ngFor="let c of courseList" [value]="c.CourseId" >{{c.ShortName}}</option>
          </select>
      </div>

      <div class="col-lg-2">
          <label>From Date:</label>
          <input type="date" class="form-control" formControlName="FromDate" [ngClass]="{ 'is-invalid': submitted && f.FromDate.errors }">
          <div *ngIf="submitted && f.FromDate.errors" class="invalid-feedback">
              <div *ngIf="f.FromDate.errors.required">Date is required</div>
            </div>
      </div> 

      <div class="col-lg-2">
          <label>To Date:</label>
          <input type="date" class="form-control" formControlName="ToDate" [ngClass]="{ 'is-invalid': submitted && f.ToDate.errors }">
          <div *ngIf="submitted && f.ToDate.errors" class="invalid-feedback">
              <div *ngIf="f.ToDate.errors.required">Date is required</div>
            </div>
      </div> 

      
      <div class="col-lg-1">
          <input type="submit" style="margin-top: 30px" value="Search" class="btn btn-primary">
      </div> 

      
      <div class="col-lg-1">
          <input type="button" class="btn btn-secondary" style="margin-top: 30px" value="Export Excel" (click)="exportAsXLSX()" >
      </div> 

      
      <!-- <div class="col-lg-1">
          <input type="button" (click)="downloadPdf()" value="Download PDF" class="btn btn-secondary" style="margin-top: 30px">
      </div>  -->

      <div class="col-lg-1">
          <input type="button" (click)="pdf.saveAs('studentAdmissionTable.pdf')" value="Download PDF" class="btn btn-secondary" style="margin-top: 30px">
      </div> 

      <!-- <button class="btn btn-secondary"  (click)="pdf.saveAs('expenseTable_.pdf')">
          Save As PDF...
        </button> -->




    </div>
  </form>

 
      <div style="margin-top: 20px">
        <kendo-pdf-export #pdf paperSize="A4" margin="1cm">
          <h4>Student Admissions Report</h4>
          <table style="border:1px solid black; width: 100%">
            <tr style="border:1px solid black">
              <th>Student Name</th>
              <th>Branch Name</th>
              <th>Course Name</th>
              <th>Gender</th>
              <th>Address</th>
              <th>City</th>
              <th>Email Id</th>
              <th>Date Of Joining</th>
              <th>Total Fees</th>
              <th>Pending Fees</th>
            </tr>
            <tr *ngFor="let s of studentAdmissionReportList | paginate: { itemsPerPage: 25, currentPage: p }" style="border:1px solid black">
              <td>{{s.StudentName}}</td>
              <td>{{s.BranchName}}</td>
              <td>{{s.CourseName}}</td>
              <td>{{s.Gender}}</td>
              <td>{{s.Address}}</td>
              <td>{{s.City}}</td>
              <td>{{s.EmailId}}</td>
              <td>{{s.DateOfJoining}}</td>
              <td>{{s.TotalFees}}</td>
              <td>{{s.PendingFees}}</td>
            </tr>
          </table>
        </kendo-pdf-export>

        <ul class="pagination">  
            <pagination-controls (pageChange)="p = $event"></pagination-controls>  
            </ul>
      </div>
   

</div>





