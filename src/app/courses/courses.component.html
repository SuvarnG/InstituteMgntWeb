<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<!-- Add top navigation componant -->
<app-authorised-top-nav></app-authorised-top-nav>

<div class="row">
  <div class="col-md-2">
    <!-- Add left navigation componant -->
    <app-authorised-side-nav></app-authorised-side-nav>
  </div>



  <div class="col-md-10">
    <div class="row mb-4 px-0 py-1">
      <div class="col-md-10 mt-4 ">
        <a routerLink="/" class="ml-3 pt-1 text-dark" data-toggle="tooltip" data-placement="bottom" title="home">
          Home</a>&nbsp;
        <i class="fa fa-angle-double-right" aria-hidden="true"></i>
        <a routerLink="/Courses" class="pt-1 text-dark" data-toggle="tooltip" data-placement="bottom" title="Courses">
          Enquiry</a>&nbsp;
      </div>
    </div>
    <hr>
    <div class="row m-3 ">
      <div class="col-md-6  py-1">
        <h2 class="h1 font-weight-medium  mt-3">Courses</h2>
      </div>

      <div class="col-md-6 px-2 pt-2 py-1 justify-content-end text-right">

        <a routerLink="/Courses" class="btn btn-info font-weight-medium px-3 py-2 rounded-0 f-20 ml-1 pull-right"
          data-toggle="tooltip" data-placement="bottom" title="Create New" (click)="AddCourses(Addtemplate)">
          Add Courses</a>&nbsp;
      </div>
    </div>



    <div class="container shadow mt-4 p-5 ml-3">
      <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="row-border hover">
        <thead>
          <tr>
            <th>No</th>

            <th>Course Type</th>
            <th>Course</th>
            <th>Full Name</th>
            <th>Is Percentage</th>
            <th>Fees</th>
            <th>Duration (In Days)</th>

            <th>Percentage</th>
            <th></th>

          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let c of course;index as i">
            <td>{{i+1}}</td>

            <td>{{c.CourseTypeName}}</td>
            <td>{{c.ShortName}}</td>
            <td>{{c.FullName}}</td>
            <td><i class="material-icons">{{c.IsPercentage ? "check_circle":"cancel"}}</i> </td>
            <td>{{c.Fees}}</td>
            <td>{{c.Duration}}</td>

            <td>
              {{c.Percentage}}
            <td>
              <button type="submit" style="margin-right:5px" class="btn btn-default" data-toggle="tooltip"
                data-placement="bottom" title="Edit" (click)="Edit(editTemplate,c)">
                <i class="fas fa-pencil-alt"></i></button>
              <button type="submit" class="btn btn-default" data-toggle="tooltip" data-placement="bottom" title="Delete"
                (click)="Delete(c.CourseId)">
                <i style='font-size:20px' class="fa fa-trash" aria-hidden="true"></i></button></td>

          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Create model -->

  <ng-template #Addtemplate>
    <div class="modal-header">
      <h4 class=" h1 modal-title pull-left">Add Course</h4>
      <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="createForm" (ngSubmit)="onSubmit()">

        <div class="row m-3">
          <div class="col-md-12 shadow my-3">
            <h4 class=" font-weight-medium  py-4 px-3">Course Details :</h4>

            <div class="row ">
              <div class="col-md-12 pb-4 px-4">
                <div class="form-row">
                  <!-- <div class="form-group col-md-1">
              <label for="fullName">Name</label>
            </div> -->
                  <div class="form-group col-md-3 px-3">
                    <select name="CourseTypeId" id="CourseTypeId" class="form-control" formControlName="CourseTypeId"
                      [value]="null" [ngClass]="{ 'is-invalid': submitted &&
            f.CourseTypeId.errors }">
                      <option [value]="null">Select Course Type </option>
                      <option *ngFor="let course of coursetype" [value]="course.CourseTypeId">
                        {{course.CourseTypeName}}
                      </option>
                    </select>
                    <div *ngIf="submitted && f.CourseTypeId.errors" class="invalid-feedback">
                      <div *ngIf="f.CourseTypeId.errors.required">Please Enter Name</div>
                    </div>
                  </div>
                  <div class="form-group col-md-3 px-3">
                    <input type="text" class="form-control" formControlName="ShortName" [ngClass]="{ 'is-invalid': submitted &&
                        f.ShortName.errors }" placeholder="ShortName">
                    <div *ngIf="submitted && f.ShortName.errors" class="invalid-feedback">
                      <div *ngIf="f.ShortName.errors.required">Please Enter Courses </div>

                    </div>
                  </div>

                  <div class="form-group col-md-3 px-3">
                    <input type="text" class="form-control" formControlName="FullName" [ngClass]="{ 'is-invalid': submitted &&
                        f.FullName.errors }" placeholder="Course Full Name">
                    <div *ngIf="submitted && f.FullName.errors" class="invalid-feedback">
                      <div *ngIf="f.FullName.errors.required">Please Enter Course Full Name </div>

                    </div>
                  </div>
                  <div class="form-group col-md-3 px-3">
                    <input type="text" class="form-control" formControlName="Fees" [ngClass]="{ 'is-invalid': submitted &&
                        f.Fees.errors }" placeholder="Fees">
                    <div *ngIf="submitted && f.Fees.errors" class="invalid-feedback">
                      <div *ngIf="f.Fees.errors.required">Please Enter Fees </div>
                    </div>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-3 mt-3 px-3">

                    <input type="checkbox" formControlName="IsPercentage" (click)="calculateIsPercentage()">
                    IsPercentage?

                  </div>
                  <div class="form-group col-md-3  px-3" *ngIf="f.IsPercentage.value">

                    <input type="text" class="form-control" formControlName="Percentage" [ngClass]="{ 'is-invalid': submitted &&
                        f.Percentage.errors }" placeholder="">
                    <div *ngIf="submitted && f.Percentage.errors" class="invalid-feedback">

                      <div *ngIf="f.Percentage.errors.required">required </div>

                    </div>
                  </div>

                  <div class="form-group col-md-3 px-3">

                    <input type="text" class="form-control" formControlName="Duration" [ngClass]="{ 'is-invalid': submitted &&
                          f.Duration.errors }" placeholder="Duration">
                    <div *ngIf="submitted && f.Duration.errors" class="invalid-feedback">
                      <div *ngIf="f.Duration.errors.required">Please Enter Duration </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- second Row start -->

        <div class="modal-footer">
          <button class="btn btn-info btn-lg py-1 pr-3 rounded-0 f-20" type="submit">Submit</button>
          <button class="btn btn-dark text-light btn-lg py-1 pl-3 rounded-0 f-20 ml-4 mr-0" type="button"
            (click)="modalRef.hide()">Cancel</button>
        </div>

      </form>
    </div>

  </ng-template>


  <!-- Edit Course Model -->

  <ng-template #editTemplate>
    <div class="modal-header">
      <h4 class="modal-title pull-left">Edit Courses</h4>
      <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="UpdateFormGroup" (ngSubmit)="Update()">
        <div class="row m-3">
          <div class="col-md-12 shadow my-3">
            <h4 class=" font-weight-medium py-4 px-3">Course Details :</h4>

            <div class="row ">
              <div class="col-md-12 pb-4 px-4">
                <div class="form-row">
                  <div class="form-group col-md-2 px-3">
                    <label for="CourseTypeId font-weight-bold h5 text-muted" class=" mt-3">Course Type : </label>
                  </div>

                  <div class="form-group col-md-2 px-3">
                    <select name="CourseTypeId" id="CourseTypeId" (change)="getShortName($event.target.value)"
                      class="form-control border-0" formControlName="CourseTypeId" [value]="CourseTypeId.value"
                      [ngClass]="{ 'is-invalid': submitted &&
          fu.CourseTypeId.errors }">
                      <option [value]="null">CourseType Name</option>
                      <option *ngFor="let course of coursetype" [value]="course.CourseTypeId">
                        {{course.CourseTypeName}}
                      </option>
                    </select>
                    <div *ngIf="submitted && fu.CourseTypeId.errors" class="invalid-feedback">
                      <div *ngIf="fu.CourseTypeId.errors.required">Please Enter Name</div>
                    </div>
                  </div>
                  <div class="form-group col-md-2">
                    <label for="ShortName" class=" mt-3">Course Name :</label>
                  </div>
                  <div class="form-group col-md-2 px-3">
                    <select name="ShortName" class="form-control border-0" formControlName="ShortName" [ngClass]="{ 'is-invalid': submitted &&
              fu.ShortName.errors }" (change)="getFullName($event.target.value)" [value]="CourseId.value">
                      <option [value]="null">select Courses</option>
                      <option *ngFor="let course of courses" [value]="course.CourseId">
                        {{course.ShortName}}
                      </option>
                    </select>
                    <div *ngIf="submitted && fu.ShortName.errors" class="invalid-feedback mt-3">
                      <div *ngIf="fu.ShortName.errors.required">Please </div>

                    </div>
                  </div>

                  <div class="form-group col-md-3">
                    <div class="lable mt-3" *ngIf="selectedCourse">FullName:&nbsp;{{selectedCourse.FullName}}</div>
                  </div>

                </div>

                <div class="form-row">
                  <div class="form-group col-md-2 px-3">
                    <label for="IsPercentage" class="control-label-col-sm-2 mt-3"> Is Percentage: </label>
                  </div>
                  <div class="form-group col-md-2 px-3">
                    <input type="text" class="form-control border-0" formControlName="IsPercentage" value="" [ngClass]="{ 'is-invalid': submitted &&
                            fu.IsPercentage.errors }" placeholder="">
                    <div *ngIf="submitted && fu.IsPercentage.errors" class="invalid-feedback">
                      <div *ngIf="fu.IsPercentage.errors.required">Please </div>
                    </div>
                  </div>



                  <div class="form-group col-md-2">
                    <label for="Percentage" class="control-label-col-sm-2 mt-3">Percentage : </label>
                  </div>
                  <div class="form-group col-md-2">
                    <input type="text" class="form-control border-0" formControlName="Percentage" [ngClass]="{ 'is-invalid': submitted &&
                                    fu.Percentage.errors }" placeholder="">
                    <div *ngIf="submitted && fu.Percentage.errors" class="invalid-feedback">
                      <div *ngIf="fu.Percentage.errors.required"> </div>
                    </div>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group col-md-1">
                    <label for="Fees" class="mt-3">Fees :</label>
                  </div>
                  <div class="form-group col-md-3 px-3">

                    <input type="text" class="form-control border-0" formControlName="Fees" [ngClass]="{ 'is-invalid': submitted &&
                          fu.Fees.errors }" placeholder="">
                    <div *ngIf="submitted && fu.Fees.errors" class="invalid-feedback">
                      <div *ngIf="fu.Fees.errors.required">Please </div>
                    </div>

                  </div>
                  <div class="form-group col-md-2">
                    <label for="Duration" class=" mt-3">Duration :</label>
                  </div>
                  <div class="form-group col-md-3 px-3">

                    <input type="text" class="form-control border-0" formControlName="Duration" [ngClass]="{ 'is-invalid': submitted &&
                            f.Duration.errors }" placeholder="Duration">
                    <div *ngIf="submitted && f.Duration.errors" class="invalid-feedback">
                      <div *ngIf="f.Duration.errors.required">Please Enter Duration </div>
                    </div>
                  </div>

                </div>

              </div>
            </div>
          </div>
        </div>
        <!-- second Row start -->

        <div class="modal-footer">
          <button class="btn btn-info btn-lg py-1 pr-3 rounded-0 f-20" type="submit">Update</button>
          <button class="btn btn-dark text-light btn-lg py-1 pl-3 rounded-0 f-20 ml-4 mr-0" type="button"
            (click)="modalRef.hide()">Cancel</button>
        </div>

      </form>
    </div>
  </ng-template>